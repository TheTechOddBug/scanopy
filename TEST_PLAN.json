{
  "branch": "brevo-integration",
  "tests": [
    {
      "id": "brevo-backfill-creates-contacts-and-companies",
      "category": "Startup Backfill",
      "description": "Backfill creates Brevo contacts and companies for all orgs",
      "setup": "Verify all organizations have a non-NULL brevo_company_id in the database, confirming the startup backfill has completed.",
      "steps": [
        "In Brevo dashboard, go to Contacts and verify each org owner appears with correct attributes (SCANOPY_USER_ID, FIRSTNAME, LASTNAME, SCANOPY_LAST_LOGIN_DATE)",
        "Go to Companies and verify each org has a company with correct attributes (scanopy_org_id, scanopy_plan_type, entity counts)",
        "Click a company and verify the owner contact is linked to it"
      ],
      "expected": "Each organization's owner exists as a Brevo contact with correct attributes including SCANOPY_LAST_LOGIN_DATE set to signup time. Each org has a corresponding company with matching attributes. Contact is linked to company.",
      "status": null,
      "feedback": null
    },
    {
      "id": "brevo-enterprise-inquiry-form-updated",
      "category": "Enterprise Inquiry",
      "description": "Inquiry form hides email/company, shows required indicators, and creates deal",
      "setup": "Verify the test user's org has a non-NULL brevo_company_id in the database.",
      "steps": [
        "In Scanopy, navigate to Settings > Billing",
        "Open the enterprise inquiry modal",
        "Verify the form does NOT show email or company fields",
        "Verify Company Size and urgency fields show a required indicator (asterisk)",
        "Try submitting with Company Size and urgency left unselected â€” verify validation errors appear",
        "Fill in all fields (name, company size, urgency, network count, message) and submit",
        "In Brevo, go to Deals and verify a new deal was created with correct attributes"
      ],
      "expected": "Email and company fields are hidden. Company Size and urgency show required indicators. Form validates required fields before submit. Successful submission creates a deal in Brevo linked to the org's company.",
      "status": null,
      "feedback": null
    },
    {
      "id": "brevo-cookie-consent-with-brevo",
      "category": "Frontend Cleanup",
      "description": "Cookie consent banner appears when Brevo is configured",
      "steps": [
        "Clear all cookies for the Scanopy app",
        "Load the app in a browser",
        "Verify the cookie consent banner appears"
      ],
      "expected": "Cookie consent banner is displayed to new visitors when SCANOPY_BREVO_API_KEY is configured.",
      "status": null,
      "feedback": null
    }
  ]
}
